<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è™šæ‹Ÿ DOM å—ç¼–è¾‘å™¨ç¤ºä¾‹</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
        }

        #editor {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            min-height: 600px;
            padding: 20px;
        }

        .info {
            max-width: 800px;
            margin: 20px auto;
            padding: 16px;
            background: #e3f2fd;
            border-radius: 8px;
            border-left: 4px solid #17b3a3;
        }

        .info h3 {
            margin-top: 0;
            color: #17b3a3;
        }

        .info code {
            background: rgba(0, 0, 0, 0.05);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }

        .controls {
            max-width: 800px;
            margin: 20px auto;
            padding: 16px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .controls button {
            margin: 4px;
            padding: 8px 16px;
            border: 1px solid #17b3a3;
            background: white;
            color: #17b3a3;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .controls button:hover {
            background: #17b3a3;
            color: white;
        }
    </style>
</head>

<body>
    <div class="info">
        <h3>ğŸš€ è™šæ‹Ÿ DOM ç‰ˆæœ¬ç¼–è¾‘å™¨</h3>
        <p>è¿™ä¸ªç¼–è¾‘å™¨ä½¿ç”¨è™šæ‹Ÿ DOM ç³»ç»Ÿï¼Œæä¾›æ›´å¥½çš„æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
        <p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
        <ul>
            <li>âœ… <strong>è™šæ‹Ÿ DOM è‡ªåŠ¨ä¼˜åŒ–</strong>ï¼šåªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼Œä¸é‡æ–°æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨</li>
            <li>âœ… <strong>ç»„ä»¶åŒ–æ¶æ„</strong>ï¼šæ¯ä¸ªå—ç±»å‹éƒ½æ˜¯ç‹¬ç«‹ç»„ä»¶ï¼Œæ˜“äºæ‰©å±•</li>
            <li>âœ… <strong>å£°æ˜å¼ç¼–ç¨‹</strong>ï¼šä½¿ç”¨ h() å‡½æ•°å£°æ˜å¼æè¿° UIï¼Œä»£ç æ›´æ¸…æ™°</li>
            <li>âœ… <strong>ç±»å‹å®‰å…¨</strong>ï¼šå®Œæ•´çš„ TypeScript ç±»å‹æ”¯æŒ</li>
            <li>âœ… <strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ diff ç®—æ³•æœ€å°åŒ– DOM æ“ä½œ</li>
        </ul>
        <p><strong>å­¦ä¹ è¦ç‚¹ï¼š</strong></p>
        <ul>
            <li>æŸ¥çœ‹ <code>app/virtual-dom.ts</code> äº†è§£è™šæ‹Ÿ DOM æ ¸å¿ƒå®ç°</li>
            <li>æŸ¥çœ‹ <code>app/vdom-renderer.ts</code> äº†è§£å¦‚ä½•åº”ç”¨åˆ°å—ç¼–è¾‘å™¨</li>
            <li>æŸ¥çœ‹ <code>app/vdom-block-editor-example.ts</code> äº†è§£å®Œæ•´ä½¿ç”¨æ–¹å¼</li>
        </ul>
    </div>

    <div class="controls">
        <h4>æ“ä½œé¢æ¿</h4>
        <button onclick="addParagraph()">æ·»åŠ æ®µè½</button>
        <button onclick="addHeading()">æ·»åŠ æ ‡é¢˜</button>
        <button onclick="addCode()">æ·»åŠ ä»£ç å—</button>
        <button onclick="addQuote()">æ·»åŠ å¼•ç”¨</button>
        <button onclick="updateFirstBlock()">æ›´æ–°ç¬¬ä¸€ä¸ªå—</button>
        <button onclick="deleteLastBlock()">åˆ é™¤æœ€åä¸€ä¸ªå—</button>
    </div>

    <div id="editor"></div>
    <script type="module">
        import { createVDOMBlockEditor } from '../app/vdom-block-editor-example.ts';
        
        // åˆ›å»ºç¼–è¾‘å™¨å®ä¾‹
        let editor;
        
        window.addEventListener('DOMContentLoaded', () => {
            editor = createVDOMBlockEditor('editor');
            console.log('è™šæ‹Ÿ DOM å—ç¼–è¾‘å™¨å·²åˆå§‹åŒ–', editor);
            
            // å°†ç¼–è¾‘å™¨æš´éœ²åˆ°å…¨å±€ï¼Œæ–¹ä¾¿æ§åˆ¶å°æ“ä½œ
            window.editor = editor;
        });

        // æ“ä½œå‡½æ•°
        function addParagraph() {
            if (editor) {
                editor.insertBlock('paragraph', 'è¿™æ˜¯ä¸€ä¸ªæ–°æ®µè½ï¼Œç”±è™šæ‹Ÿ DOM æ¸²æŸ“ã€‚');
            }
        }

        function addHeading() {
            if (editor) {
                const block = editor.insertBlock('heading', 'è¿™æ˜¯ä¸€ä¸ªæ–°æ ‡é¢˜');
                // æ›´æ–°æ ‡é¢˜çº§åˆ«
                if (block) {
                    editor.updateBlock(block.id, { props: { level: 2 } });
                }
            }
        }

        function addCode() {
            if (editor) {
                editor.insertBlock('code', 'const hello = "Virtual DOM";\nconsole.log(hello);');
            }
        }

        function addQuote() {
            if (editor) {
                editor.insertBlock('quote', 'è¿™æ˜¯ä¸€æ®µå¼•ç”¨æ–‡å­—ï¼Œå±•ç¤ºè™šæ‹Ÿ DOM çš„æ¸²æŸ“èƒ½åŠ›ã€‚');
            }
        }

        function updateFirstBlock() {
            if (editor) {
                const blocks = editor.getDatabase().getAllBlocks();
                if (blocks.length > 0) {
                    editor.updateBlock(blocks[0].id, { 
                        content: 'âœ… å†…å®¹å·²æ›´æ–°ï¼è™šæ‹Ÿ DOM è‡ªåŠ¨ä¼˜åŒ–äº†è¿™æ¬¡æ›´æ–°ï¼Œåªæ›´æ–°äº†å˜åŒ–çš„æ–‡æœ¬ï¼Œæ²¡æœ‰é‡æ–°æ¸²æŸ“æ•´ä¸ªå—ã€‚' 
                    });
                }
            }
        }

        function deleteLastBlock() {
            if (editor) {
                const blocks = editor.getDatabase().getAllBlocks();
                if (blocks.length > 0) {
                    editor.deleteBlock(blocks[blocks.length - 1].id);
                }
            }
        }

        // æš´éœ²åˆ°å…¨å±€
        window.addParagraph = addParagraph;
        window.addHeading = addHeading;
        window.addCode = addCode;
        window.addQuote = addQuote;
        window.updateFirstBlock = updateFirstBlock;
        window.deleteLastBlock = deleteLastBlock;
    </script>
</body>

</html>

